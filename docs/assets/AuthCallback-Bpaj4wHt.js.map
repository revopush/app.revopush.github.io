{"version":3,"file":"AuthCallback-Bpaj4wHt.js","sources":["../../src/screens/Login/AuthCallback.tsx"],"sourcesContent":["import { type FC, useEffect, useRef } from 'react';\nimport { useSearchParams, useParams, useNavigate } from 'react-router';\nimport { callbackAuthProvider } from '../../api/client.ts';\nimport { Flex, Layout, Spin } from 'antd';\n\nconst { Content } = Layout;\n\nconst AuthCallback: FC = () => {\n  const navigate = useNavigate();\n  const { provider } = useParams();\n  const [searchParams] = useSearchParams();\n\n  const hasEffectRun = useRef(false);\n\n  useEffect(() => {\n    const handlePopState = () => {\n      navigate('/');\n    };\n\n    window.addEventListener('popstate', handlePopState);\n\n    return () => {\n      window.removeEventListener('popstate', handlePopState);\n    };\n  }, [navigate]);\n\n  useEffect(() => {\n    if (!hasEffectRun.current) {\n      const queryParams = Object.fromEntries(searchParams.entries());\n      const queryString = new URLSearchParams(queryParams).toString();\n      hasEffectRun.current = true;\n\n      callbackAuthProvider(queryString, provider)\n        .then((response) => {\n          if (response?.accountId) {\n            navigate('/');\n          }\n        })\n        .catch((error) => {\n          if (error?.status === 409) {\n            navigate('/login?accountExists=true');\n          }\n          if (error?.status === 403) {\n            navigate('/register?accountEmpty=true');\n          }\n        });\n    }\n  }, [navigate, provider, searchParams]);\n\n  return (\n    <Layout>\n      <Content>\n        <Flex\n          justify=\"center\"\n          align=\"center\"\n          style={{ height: '100vh' }}\n          vertical\n        >\n          <Spin size=\"large\" />\n        </Flex>\n      </Content>\n    </Layout>\n  );\n};\n\nexport default AuthCallback;\n"],"names":["Content","Layout","AuthCallback","navigate","useNavigate","provider","useParams","searchParams","useSearchParams","hasEffectRun","useRef","useEffect","handlePopState","queryParams","queryString","callbackAuthProvider","response","error","jsx","Flex","Spin"],"mappings":"6bAKA,KAAM,CAAE,QAAAA,CAAY,EAAAC,EAEdC,EAAmB,IAAM,CAC7B,MAAMC,EAAWC,EAAY,EACvB,CAAE,SAAAC,CAAS,EAAIC,EAAU,EACzB,CAACC,CAAY,EAAIC,EAAgB,EAEjCC,EAAeC,SAAO,EAAK,EAEjCC,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAiB,IAAM,CAC3BT,EAAS,GAAG,CACd,EAEO,cAAA,iBAAiB,WAAYS,CAAc,EAE3C,IAAM,CACJ,OAAA,oBAAoB,WAAYA,CAAc,CACvD,CAAA,EACC,CAACT,CAAQ,CAAC,EAEbQ,EAAAA,UAAU,IAAM,CACV,GAAA,CAACF,EAAa,QAAS,CACzB,MAAMI,EAAc,OAAO,YAAYN,EAAa,SAAS,EACvDO,EAAc,IAAI,gBAAgBD,CAAW,EAAE,SAAS,EAC9DJ,EAAa,QAAU,GAEvBM,EAAqBD,EAAaT,CAAQ,EACvC,KAAMW,GAAa,CACdA,GAAA,MAAAA,EAAU,WACZb,EAAS,GAAG,CACd,CACD,EACA,MAAOc,GAAU,EACZA,GAAA,YAAAA,EAAO,UAAW,KACpBd,EAAS,2BAA2B,GAElCc,GAAA,YAAAA,EAAO,UAAW,KACpBd,EAAS,6BAA6B,CACxC,CACD,CAAA,CAEJ,EAAA,CAACA,EAAUE,EAAUE,CAAY,CAAC,EAGnCW,EAAAA,IAACjB,EACC,CAAA,SAAAiB,EAAAA,IAAClB,EACC,CAAA,SAAAkB,EAAA,IAACC,EAAA,CACC,QAAQ,SACR,MAAM,SACN,MAAO,CAAE,OAAQ,OAAQ,EACzB,SAAQ,GAER,SAAAD,EAAAA,IAACE,EAAK,CAAA,KAAK,OAAQ,CAAA,CAAA,GAEvB,CACF,CAAA,CAEJ"}