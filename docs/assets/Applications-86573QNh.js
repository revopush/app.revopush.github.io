import{o as k,j as e,p as I,q as M,r as m,F as y,B as f,s as E,T as b,t as T,f as R,h as P,L as A,k as v,i as N,l as D,n as _}from"./index-Dzs6o6Dg.js";import{S as q,B,R as O}from"./SideBar-CVm2-X6H.js";import{u as h,a as g}from"./useErrorMessage-CIwAEmCD.js";import{F as u,I as w,a as L}from"./Table-ClvFYQuL.js";import{M as F}from"./index-Dt8ex364.js";import{T as $,t as K}from"./tags-CujmHIJp.js";import{P as W}from"./index-CVluZupw.js";import{R as G,a as H}from"./MoreOutlined-ChKkuImL.js";import{R as Q}from"./index-Bp6bbdPA.js";import"./PurePanel-BmIXK2EO.js";import"./row-BX7Sfg-X.js";import"./Pagination-CE5hpjlK.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new a.Error().stack;o&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[o]="408c7c76-58aa-49d0-a335-65cdb5bf1291",a._sentryDebugIdIdentifier="sentry-dbid-408c7c76-58aa-49d0-a335-65cdb5bf1291")}catch{}})();const U=({isOpen:a,onSuccess:o,onCancel:r})=>{const[i]=u.useForm(),s=h(),{mutate:c,isPending:p}=g({mutationFn:k,onSuccess:()=>{i.resetFields(),o()},onError:n=>{s(n,"Couldn't create new app")}}),l=({appName:n})=>{c({name:n})},t=()=>{i.resetFields(),r()};return e.jsx(e.Fragment,{children:e.jsx(F,{title:"New application",open:a,okText:"Add new app",onOk:()=>i.submit(),confirmLoading:p,onCancel:t,children:e.jsx(u,{form:i,layout:"vertical",onFinish:l,children:e.jsx(u.Item,{label:"Appication name",extra:"With new app we create default deployments: Production and Staging",name:"appName",rules:[{required:!0,message:"Please input your application name!"}],children:e.jsx(w,{})})})})})},{Text:V}=b,z=(a,o)=>{const{message:r,modal:i}=I.useApp(),s=h(),{mutate:c}=g({mutationFn:M,onSuccess:()=>{r.success("Successfully deleted"),a()},onError:l=>{s(l,"Couldn't delete application")}});return m.useMemo(()=>[{title:"Name",dataIndex:"name",key:"name",minWidth:200,className:"table-cursor",render:l=>l},{title:"Deployments",key:"deployments",dataIndex:"deployments",render:(l,{deployments:t})=>(t==null?void 0:t.length)>0?t==null?void 0:t.map((n,d)=>e.jsx($,{color:K[d],children:n},d)):e.jsx(V,{type:"secondary",children:"No deployments yet"})},{title:"Actions",key:"actions",width:100,align:"center",render:(l,t)=>e.jsx(W,{content:e.jsxs(y,{vertical:!0,gap:"small",children:[e.jsx(f,{onClick:n=>{n.stopPropagation(),o(t==null?void 0:t.name)},type:"text",icon:e.jsx(E,{}),children:"Edit"}),e.jsx(f,{onClick:n=>{n.stopPropagation(),i.confirm({icon:null,title:"Confirm",content:"Are you sure you want to remove application?",onOk:()=>{c(t==null?void 0:t.name)}})},type:"text",danger:!0,icon:e.jsx(G,{}),children:"Delete"})]}),trigger:"click",children:e.jsx(f,{onClick:n=>{n.stopPropagation()},icon:e.jsx(H,{}),type:"text"})})}],[i,c,o])},J=({isOpen:a,application:o,onSuccess:r,onCancel:i})=>{const[s]=u.useForm(),c=h();m.useEffect(()=>{s.setFieldValue("appName",o)},[s,o]);const{mutate:p,isPending:l}=g({mutationFn:T,onSuccess:()=>{s.resetFields(),r()},onError:d=>{c(d,"Couldn't update application")}}),t=({appName:d})=>{p({name:o,newName:d})},n=()=>{s.resetFields(),i()};return e.jsx(e.Fragment,{children:e.jsx(F,{title:"Edit application",open:a,okText:"Update app",onOk:()=>s.submit(),confirmLoading:l,onCancel:n,children:e.jsx(u,{form:s,layout:"vertical",onFinish:t,children:e.jsx(u.Item,{label:"Appication name",name:"appName",rules:[{required:!0,message:"Please input your application name!"}],children:e.jsx(w,{})})})})})},{Title:X}=b,{Content:Y}=A,de=()=>{var j;const a=R(),[o,r]=m.useState(null),[i,s]=m.useState(!1),[c,p]=m.useState(!1),{isPending:l,data:t,refetch:n}=P({queryKey:["apps"],queryFn:_}),C=z(n,x=>{r(x),p(!0)}),S=[{title:"Home",onClick:()=>a("/")},{title:"Applications"}];return e.jsxs(q,{children:[e.jsx(A,{children:e.jsxs(Y,{style:{paddingRight:50,paddingTop:20},children:[e.jsx(B,{separator:">",items:S}),e.jsxs(y,{align:"center",justify:"space-between",children:[e.jsx(X,{level:2,children:"Applications"}),e.jsx(f,{onClick:()=>s(!0),type:"primary",children:"Add an Application"})]}),e.jsx(v,{loading:l,children:((j=t==null?void 0:t.apps)==null?void 0:j.length)>0?e.jsx(L,{rowKey:"name",columns:C,dataSource:t.apps,pagination:!1,onRow:x=>({onClick:()=>{a(`/applications/${x.name}`)}})}):e.jsx(N,{children:e.jsx(Q,{title:"Start your project",subTitle:"Get started with Revopush by creating an application.",icon:e.jsx(O,{}),extra:[e.jsx(f,{onClick:()=>s(!0),type:"default",children:"Add an Application"},"console")]})})})]})}),e.jsx(U,{isOpen:i,onCancel:()=>s(!1),onSuccess:()=>{n(),s(!1)}}),e.jsx(J,{isOpen:c,application:o,onCancel:()=>{p(!1),r(null)},onSuccess:()=>{n(),r(null),p(!1)}}),e.jsx(D,{})]})};export{de as default};
//# sourceMappingURL=Applications-86573QNh.js.map
