import{cE as j,f as b,o as w,r,j as t,L as f,F as u,i as T,B as k,cF as v,l as A,T as E,aZ as I}from"./index-dpZwHUji.js";import{u as S}from"./useMutation-Cs0bAhCf.js";import{d as h}from"./dayjs.min-BTJJzxYL.js";import{d as C}from"./duration-CvvJIPrV.js";import{R as F}from"./index-DeCq-U0k.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new s.Error().stack;o&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[o]="41a3a6e2-ed6a-4fac-88b5-2658052c0262",s._sentryDebugIdIdentifier="sentry-dbid-41a3a6e2-ed6a-4fac-88b5-2658052c0262")}catch{}})();h.extend(C);const{Content:P}=f,{Title:D,Paragraph:K,Text:y}=E,z=()=>{const[s]=j(),o=b(),{message:i}=w.useApp(),[g,m]=r.useState(null),{mutate:c,isPending:p,isError:x,error:a}=S({mutationFn:I,onSuccess:e=>{var n,d,l;(n=e==null?void 0:e.data)!=null&&n.accessKey&&m((l=(d=e==null?void 0:e.data)==null?void 0:d.accessKey)==null?void 0:l.name)},onError:e=>{var n;e.status!==409&&i.open({type:"error",content:((n=e==null?void 0:e.response)==null?void 0:n.data)||"Couldn't create new access key"})}});return r.useEffect(()=>{const e=s.get("hostname");if(e){const n=h.duration(60,"days").asMilliseconds();c({friendlyName:e,ttl:n})}},[c,s]),t.jsx(f,{children:t.jsx(P,{children:t.jsxs(u,{justify:"center",align:"center",style:{height:"100vh"},vertical:!0,children:[t.jsx(T,{loading:p,children:x||!s.get("hostname")?t.jsx(F,{status:"error",title:(a==null?void 0:a.status)===409?"The access key already exists":"Authentication Failed",subTitle:(a==null?void 0:a.status)===409?"Got to Settings -> Add new key to release a new key.":"Try again or contact our support: support@revopush.org",extra:(a==null?void 0:a.status)===409?[t.jsx(k,{onClick:()=>o("/settings"),type:"primary",children:"Go to Settings"},"console")]:[]}):t.jsxs(u,{justify:"center",align:"start",vertical:!0,children:[t.jsx(D,{level:2,style:{marginBottom:0,marginTop:0},children:"Authentication succeeded"}),t.jsx("br",{}),t.jsx(y,{children:"Please copy and paste this token to the command window:"}),t.jsx("br",{}),t.jsx(K,{code:!0,copyable:{icon:t.jsx(v,{style:{fontSize:18,marginLeft:10}})},style:{fontSize:22},children:g}),t.jsx(y,{children:"After doing so, please close this browser tab."})]})}),t.jsx(A,{})]})})})};export{z as default};
//# sourceMappingURL=GenerateCLIToken-9CjQXntA.js.map
